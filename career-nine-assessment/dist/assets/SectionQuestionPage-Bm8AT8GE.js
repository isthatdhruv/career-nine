const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/JungleSpotGame-CPJUKC4P.js","assets/index-DoebR7eq.js","assets/router-Cb5lJ_RW.js","assets/index-DBkz-poX.css","assets/RabbitPathGame-CFFkyLq7.js","assets/HydroTubeGame-BmSTbHJj.js"])))=>i.map(i=>d[i]);
import{j as t,_ as ce,b as Ke,u as Xe,a as Ze}from"./index-DoebR7eq.js";import{b as d,c as et,u as tt,R as K}from"./router-Cb5lJ_RW.js";const nt=d.lazy(()=>ce(()=>import("./JungleSpotGame-CPJUKC4P.js"),__vite__mapDeps([0,1,2,3])).then(o=>({default:o.JungleSpotGame}))),st=d.lazy(()=>ce(()=>import("./RabbitPathGame-CFFkyLq7.js"),__vite__mapDeps([4,1,2,3])).then(o=>({default:o.RabbitPathGame}))),ot=d.lazy(()=>ce(()=>import("./HydroTubeGame-BmSTbHJj.js"),__vite__mapDeps([5,1,2,3])).then(o=>({default:o.HydroTubeGame}))),it=()=>t.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"white"},children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading game..."})})});function rt({gameCode:o,userStudentId:k,playerName:y,onComplete:w,onExit:A}){const O=()=>{switch(o){case 101:return t.jsx(nt,{userStudentId:k,playerName:y,onComplete:w,onExit:A});case 102:return t.jsx(st,{userStudentId:k,playerName:y,onComplete:w,onExit:A});case 103:return t.jsx(ot,{userStudentId:k,playerName:y,onComplete:w,onExit:A});default:return t.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#fee2e2"},children:t.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",textAlign:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[t.jsx("h2",{style:{color:"#dc2626",marginBottom:"1rem"},children:"Unknown Game"}),t.jsxs("p",{style:{color:"#4b5563",marginBottom:"1rem"},children:["Game code ",t.jsx("strong",{children:o})," is not recognized."]}),t.jsx("button",{onClick:A,style:{background:"#dc2626",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",fontWeight:"bold",cursor:"pointer"},children:"Exit"})]})})}};return t.jsx(d.Suspense,{fallback:t.jsx(it,{}),children:O()})}function at({gameCode:o,userStudentId:k,playerName:y,onComplete:w,onExit:A}){const{saveAnimalReaction:O,saveRabbitPath:j,saveHydroTube:L}=Ke(),b=d.useCallback(async p=>{console.log("=== Game Complete Handler Called ==="),console.log("Received data:",p),console.log("Game code:",o);try{switch(o){case 101:console.log("Saving Jungle-Spot via DataContext..."),await O({totalTrials:p.totalTrials,trialMs:p.trialMs,target:p.target,targetsShown:p.targetsShown,hits:p.hits,misses:p.misses,falsePositives:p.falsePositives,hitRTsMs:p.hitRTsMs||[]},k),console.log("Jungle-Spot results saved via DataContext!");break;case 102:console.log("Saving Rabbit-Path via DataContext..."),await j({score:p.score,totalRounds:p.totalRounds,roundsPlayed:p.roundsPlayed,history:p.history},k),console.log("Rabbit-Path results saved via DataContext!");break;case 103:console.log("Saving Hydro-Tube via DataContext..."),await L({patternsCompleted:p.patternsCompleted,totalPatterns:p.totalPatterns,aimlessRotations:p.aimlessRotations,curiousClicks:p.curiousClicks,tilesCorrect:p.tilesCorrect,totalTiles:p.totalTiles,timeSpentSeconds:p.timeSpentSeconds},k),console.log("Hydro-Tube results saved via DataContext!");break;default:console.warn("Unknown game code:",o)}}catch(H){console.error("Failed to save game results:",H),console.error("Error message:",H?.message)}w()},[w,k,o,O,j,L]),X=d.useCallback(()=>{A()},[A]);return t.jsx("div",{style:{position:"fixed",inset:0,zIndex:9999,backgroundColor:"white",overflowY:"auto",width:"100%",height:"100%"},children:t.jsx(rt,{gameCode:o,userStudentId:k,playerName:y,onComplete:b,onExit:X})})}function lt(o=500){const k=d.useRef({}),y=d.useRef(null),w=d.useCallback(()=>{const O=k.current;k.current={};for(const[j,L]of Object.entries(O))try{localStorage.setItem(j,L)}catch(b){console.error(`Failed to write localStorage key "${j}":`,b)}},[]),A=d.useCallback((O,j)=>{k.current[O]=j,y.current&&clearTimeout(y.current),y.current=setTimeout(w,o)},[o,w]);return d.useEffect(()=>()=>{y.current&&clearTimeout(y.current),w()},[w]),{scheduleWrite:A,flush:w}}const ut=()=>{const{sectionId:o,questionIndex:k}=et(),y=tt(),{assessmentData:w,assessmentConfig:A}=Xe(),O=A?.showTimer!==!1;Ze();const{scheduleWrite:j,flush:L}=lt(500),[b,X]=d.useState(null),[p,H]=d.useState([]),[q,de]=d.useState(0),[he,be]=d.useState([]),[Se,ye]=d.useState(null),[je,U]=d.useState(!1),[Z,we]=d.useState(()=>{const e=localStorage.getItem("assessmentSeenSectionInstructions");return e?new Set(JSON.parse(e)):new Set}),[ke,ee]=d.useState(!1),[te,Ie]=d.useState([]),[ve,ne]=d.useState(!1),[P,se]=d.useState(null),[z,oe]=d.useState(()=>{const e=localStorage.getItem("assessmentAnswers");return e?JSON.parse(e):{}}),[N,ue]=d.useState(()=>{const e=localStorage.getItem("assessmentRankingAnswers");return e?JSON.parse(e):{}}),[F,Te]=d.useState(()=>{const e=localStorage.getItem("assessmentSavedForLater");if(e){const n=JSON.parse(e),i={};for(const r in n)i[r]=new Set(n[r]);return i}return{}}),[M,G]=d.useState(()=>{const e=localStorage.getItem("assessmentSkipped");if(e){const n=JSON.parse(e),i={};for(const r in n)i[r]=new Set(n[r]);return i}return{}}),[ie,qe]=d.useState(()=>{const e=localStorage.getItem("assessmentElapsedTime");return e?parseInt(e):0}),[$,ge]=d.useState(()=>{const e=localStorage.getItem("assessmentTextAnswers");return e?JSON.parse(e):{}}),[Ce,Y]=d.useState(null),[xe,re]=d.useState({}),D=d.useRef({}),[E,Re]=d.useState(()=>{const e=localStorage.getItem("assessmentCompletedGames");return e?JSON.parse(e):{}});d.useEffect(()=>{if(w&&w[0]){const e=w[0];X(e);const n=e.sections.find(i=>String(i.section.sectionId)===String(o));if(!n)return;ye(n),H(n.questions||[]),de(Number(k)||0),be(e.languages||[])}},[o,k,w]),d.useEffect(()=>{j("assessmentAnswers",JSON.stringify(z))},[z,j]),d.useEffect(()=>{j("assessmentRankingAnswers",JSON.stringify(N))},[N,j]),d.useEffect(()=>{const e={};for(const n in F)e[n]=Array.from(F[n]);j("assessmentSavedForLater",JSON.stringify(e))},[F,j]),d.useEffect(()=>{const e={};for(const n in M)e[n]=Array.from(M[n]);j("assessmentSkipped",JSON.stringify(e))},[M,j]),d.useEffect(()=>{localStorage.setItem("assessmentElapsedTime",String(ie))},[ie]),d.useEffect(()=>{j("assessmentCompletedGames",JSON.stringify(E))},[E,j]),d.useEffect(()=>{j("assessmentTextAnswers",JSON.stringify($))},[$,j]),d.useEffect(()=>{j("assessmentSeenSectionInstructions",JSON.stringify(Array.from(Z)))},[Z,j]),d.useEffect(()=>{if(!o||!b||Z.has(o))return;const e=b.sections.find(n=>String(n.section.sectionId)===String(o));if(e?.instruction&&e.instruction.length>0){const n=r=>{if(!r)return!1;const s=r.trim().toUpperCase();return s==="NA"||s==="N/A"},i=e.instruction.filter(r=>r.instructionText&&!n(r.instructionText)).map(r=>({text:r.instructionText,language:r.language?.languageName||"English"}));i.length>0&&(Ie(i),ee(!0))}we(n=>{const i=new Set(n);return i.add(o),i})},[o,b]),d.useEffect(()=>{const e=setInterval(()=>{qe(n=>n+1)},1e3);return()=>clearInterval(e)},[]);const Ae=e=>{const n=Math.floor(e/3600),i=Math.floor(e%3600/60),r=e%60;return`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`};if(!b||!p.length)return t.jsx("div",{className:"text-center mt-5",children:"No questions found"});const h=p[q],x=h.questionnaireQuestionId,C=z[o]?.[x]||[],I=he.filter(e=>e.language.languageId===100?!0:h.question.languageQuestions?.some(n=>n.language.languageId===e.language.languageId)),Ne=()=>b?b.sections.findIndex(n=>String(n.section.sectionId)===String(o))===b.sections.length-1:!1,fe=()=>Ne()&&q===p.length-1,me=()=>{if(!b)return!1;for(const e of b.sections){const n=String(e.section.sectionId);for(const i of e.questions){const r=i.questionnaireQuestionId,s=i.question.questionType==="ranking",a=i.question.questionType==="text"||i.question.isMQTtyped===!0;let c=!1;if(a){const l=$[n]?.[r]||{};c=Object.values(l).some(f=>f.trim().length>0)}else if(s){const l=N[n]?.[r]||{};c=Object.keys(l).length>0}else c=z[n]?.[r]?.length>0;if(!c)return!1}}return!0},Oe=()=>{const e=[];if(b&&b.sections)for(const s of b.sections){const a=String(s.section.sectionId);for(const c of s.questions){const l=c.questionnaireQuestionId,f=c.question.questionType==="ranking";if(c.question.questionType==="text"||c.question.isMQTtyped===!0){const m=$[a]?.[l]||{},u=c.question.options||[];for(const[,S]of Object.entries(m)){const T=S.trim();if(T){const v=T.replace(/\s+/g," ").toLowerCase(),R=u.find(le=>(le.optionText||"").trim().replace(/\s+/g," ").toLowerCase()===v);R?e.push({questionnaireQuestionId:l,optionId:R.optionId}):e.push({questionnaireQuestionId:l,textResponse:T})}}}else if(f){const m=N[a]?.[l]||{};for(const[u,S]of Object.entries(m)){const T={questionnaireQuestionId:l,optionId:parseInt(u),rankOrder:S};e.push(T)}}else{const m=z[a]?.[l]||[];if(m.length>0)for(const u of m){const S={questionnaireQuestionId:l,optionId:u};e.push(S)}}}}const n=localStorage.getItem("userStudentId")?parseInt(localStorage.getItem("userStudentId")):null,i=localStorage.getItem("assessmentId")?parseInt(localStorage.getItem("assessmentId")):null;return{userStudentId:n,assessmentId:i,status:"completed",answers:e}},ze=()=>{G(e=>{const n=new Set(e[o]||[]);return n.add(x),{...e,[o]:n}})},$e=e=>{const n=C.length,i=C.includes(e),r=h.question.maxOptionsAllowed,s=!i&&r>0&&n+1===r;oe(a=>{const c=a[o]||{},l=c[x]||[];if(l.includes(e)){const f=l.filter(g=>g!==e);return{...a,[o]:{...c,[x]:f}}}else if(h.question.maxOptionsAllowed===0||l.length<h.question.maxOptionsAllowed){const f=[...l,e];return{...a,[o]:{...c,[x]:f}}}return a}),G(a=>{const c=new Set(a[o]||[]);return c.delete(x),{...a,[o]:c}}),s&&setTimeout(()=>{const a=_(o,q,x);a&&y(`/studentAssessment/sections/${a.sectionId}/questions/${a.questionIndex}`)},400)},We=(e,n)=>{const i=N[o]?.[x]||{},r=Object.keys(i).length,s=h.question.maxOptionsAllowed,c=n!==null&&!i[e]&&r+1===s;ue(l=>{const f=l[o]||{},g=f[x]||{};if(n===null){const{[e]:m,...u}=g;return{...l,[o]:{...f,[x]:u}}}else return{...l,[o]:{...f,[x]:{...g,[e]:n}}}}),n!==null&&G(l=>{const f=new Set(l[o]||[]);return f.delete(x),{...l,[o]:f}}),c&&setTimeout(()=>{const l=_(o,q,x);l&&y(`/studentAssessment/sections/${l.sectionId}/questions/${l.questionIndex}`)},400)},Ee=e=>{const n=N[o]?.[x]||{},i=new Set(Object.entries(n).filter(([a])=>parseInt(a)!==e).map(([,a])=>a)),r=h.question.maxOptionsAllowed,s=[];for(let a=1;a<=r;a++)i.has(a)||s.push(a);return s},Le=()=>{Te(n=>{const i=new Set(n[o]||[]);return i.add(x),{...n,[o]:i}}),oe(n=>{const i=n[o]||{},{[x]:r,...s}=i;return{...n,[o]:s}}),ue(n=>{const i=n[o]||{},{[x]:r,...s}=i;return{...n,[o]:s}});const e=_(o,q,x);e&&y(`/studentAssessment/sections/${e.sectionId}/questions/${e.questionIndex}`)},Ge=()=>{C.length===0&&ze();const e=_(o,q);e?y(`/studentAssessment/sections/${e.sectionId}/questions/${e.questionIndex}`):Be()},Qe=()=>{if(q>0){const e=q-1;de(e),y(`/studentAssessment/sections/${o}/questions/${e}`)}},Be=()=>{const e=b.sections.findIndex(i=>String(i.section.sectionId)===String(o)),n=b.sections[e+1];y(n?`/studentAssessment/sections/${n.section.sectionId}/questions/0`:"/studentAssessment/completed")},Pe=async()=>{if(me()){L();const e=Oe();console.log("=== ASSESSMENT SUBMISSION DATA ==="),console.log(JSON.stringify(e,null,2));const n=3;for(let i=1;i<=n;i++)try{const r=await fetch("https://api.career-9.com/assessment-answer/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(3e4)});if(!r.ok){const a=await r.text();throw new Error(`Failed to submit assessment: ${a}`)}const s=await r.json();console.log("=== SUBMISSION SUCCESSFUL ==="),console.log("Saved answers:",s),y("/studentAssessment/completed");return}catch(r){if(console.error(`Submit attempt ${i}/${n} failed:`,r),i<n){const s=Math.pow(2,i-1)*1e3;alert(`Submission failed (attempt ${i}/${n}). Retrying in ${s/1e3}s...`),await new Promise(a=>setTimeout(a,s))}else alert("Failed to submit assessment after 3 attempts. Your answers are saved locally. Please check your connection and try again.")}}else U(!0)},Fe=()=>{if(!b)return;const e=String(b.sections[0].section.sectionId),n=_(e,-1);n&&(U(!1),y(`/studentAssessment/sections/${n.sectionId}/questions/${n.questionIndex}`))},Me=d.useCallback((e,n)=>z[e]?.[n]?.length||Object.keys(N[e]?.[n]||{}).length>0||Object.values($[e]?.[n]||{}).filter(s=>s.trim()).length>0?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":F[e]?.has(n)?"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)":M[e]?.has(n)?"linear-gradient(135deg, #f87171 0%, #dc2626 100%)":"#d1d5db",[z,N,$,F,M]),_=(e,n,i)=>{if(!b)return null;const r=b.sections,s=r.findIndex(a=>String(a.section.sectionId)===e);if(s===-1)return null;for(let a=s;a<r.length;a++){const c=r[a],l=String(c.section.sectionId),f=a===s?n+1:0;for(let g=f;g<c.questions.length;g++){const m=c.questions[g],u=m.questionnaireQuestionId;if(i&&u===i)continue;const S=m.question.questionType==="ranking",T=m.question.questionType==="text"||m.question.isMQTtyped===!0;let v=!1;if(T)v=Object.values($[l]?.[u]||{}).some(R=>R.trim().length>0);else if(S){const R=N[l]?.[u]||{};v=Object.keys(R).length>0}else v=(z[l]?.[u]?.length||0)>0;if(!v)return{sectionId:l,questionIndex:g}}}for(let a=0;a<=s;a++){const c=r[a],l=String(c.section.sectionId),f=a===s?n:c.questions.length;for(let g=0;g<f;g++){const m=c.questions[g],u=m.questionnaireQuestionId;if(i&&u===i)continue;const S=m.question.questionType==="ranking",T=m.question.questionType==="text"||m.question.isMQTtyped===!0;let v=!1;if(T)v=Object.values($[l]?.[u]||{}).some(R=>R.trim().length>0);else if(S){const R=N[l]?.[u]||{};v=Object.keys(R).length>0}else v=(z[l]?.[u]?.length||0)>0;if(!v)return{sectionId:l,questionIndex:g}}}return null},De=e=>{if(e===100)return h.question.questionText;const n=h.question.languageQuestions?.find(i=>i.language.languageId===e);return n?n.questionText:h.question.questionText},V=(e,n)=>{if(n===100)return e.optionText;const i=e.languageOptions?.find(r=>r.language.languageId===n);return i?i.optionText:e.optionText},ae=e=>!!(e.optionImageBase64&&e.optionImageBase64.trim()!==""),_e=e=>e.optionImageBase64?e.optionImageBase64.startsWith("data:")?e.optionImageBase64:`data:image/png;base64,${e.optionImageBase64}`:"",pe=(e,n)=>ae(e)?t.jsx("img",{src:_e(e),alt:e.optionText||"Option image",style:{maxWidth:"200px",maxHeight:"150px",objectFit:"contain",borderRadius:"8px",border:"1px solid #e0e0e0",filter:"brightness(0.85) contrast(1.15)"}}):n!==void 0?V(e,n):e.optionText,Je=e=>e.optionDescription?t.jsx("div",{style:{fontSize:"0.85rem",color:"#9ca3af",marginTop:"4px",lineHeight:"1.4",fontWeight:400,fontStyle:"italic"},children:e.optionDescription}):null,He=e=>{se(e),ne(!0)},Ue=()=>{if(P&&o){Re(n=>({...n,[P]:!0}));const e=h.question.options.find(n=>n.isGame&&n.game?.gameCode===P);e&&(oe(n=>{const i=n[o]||{},r=i[x]||[];if(!r.includes(e.optionId)){const s=[...r,e.optionId];return console.log(`‚úÖ Game completed! Marking question ${x} as answered with option ${e.optionId}`),{...n,[o]:{...i,[x]:s}}}return n}),G(n=>{const i=new Set(n[o]||[]);return i.delete(x),{...n,[o]:i}}))}ne(!1),se(null)},Ye=()=>{ne(!1),se(null)};if(ve&&P){const e=localStorage.getItem("User Student id")||"",n=localStorage.getItem("userName")||"Student";return t.jsx(at,{gameCode:P,userStudentId:e,playerName:n,onComplete:Ue,onExit:Ye})}return t.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",colorScheme:"light"},children:[ke&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>ee(!1),children:t.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"28px 32px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto",color:"#2d3748"},onClick:e=>e.stopPropagation(),children:[t.jsx("h5",{style:{fontWeight:700,marginBottom:"16px",color:"#2d3748"},children:"Section Instructions"}),te.map((e,n)=>t.jsxs("div",{style:{marginBottom:n<te.length-1?"16px":0},children:[te.length>1&&t.jsx("div",{style:{fontSize:"0.85rem",fontWeight:600,color:"#667eea",marginBottom:"6px"},children:e.language}),t.jsx("p",{style:{whiteSpace:"pre-line",lineHeight:1.7,margin:0,fontSize:"1rem",color:"#4a5568"},children:e.text})]},n)),t.jsx("div",{style:{textAlign:"right",marginTop:"20px"},children:t.jsx("button",{onClick:()=>ee(!1),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",border:"none",borderRadius:"8px",padding:"8px 28px",fontWeight:600,fontSize:"0.95rem",cursor:"pointer"},children:"OK"})})]})}),t.jsxs("div",{style:{width:280,background:"#ffffff",borderRight:"none",display:"flex",flexDirection:"column",height:"100vh",position:"sticky",top:0,boxShadow:"4px 0 30px rgba(0,0,0,0.1)",borderRadius:"0 24px 24px 0",colorScheme:"light",color:"#2d3748"},children:[t.jsxs("div",{style:{borderBottom:"2px solid #e2e8f0",padding:"16px 20px",background:"linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%)"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"12px"},children:t.jsx("img",{src:"/media/logos/kcc.jpg",alt:"KCC Logo",style:{height:"48px",objectFit:"contain"}})}),t.jsxs("h6",{style:{fontSize:"0.85rem",fontWeight:700,color:"#2d3748",marginBottom:"10px",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{width:"6px",height:"18px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"3px"}}),"Legend"]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"6px 12px"},children:[t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("div",{style:{width:14,height:14,borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",flexShrink:0,boxShadow:"0 2px 6px rgba(102, 126, 234, 0.4)"}}),t.jsx("span",{style:{fontSize:"0.8rem",color:"#4a5568",fontWeight:500},children:"Answered"})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("div",{style:{width:14,height:14,borderRadius:"50%",background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",flexShrink:0,boxShadow:"0 2px 6px rgba(251, 191, 36, 0.4)"}}),t.jsx("span",{style:{fontSize:"0.8rem",color:"#4a5568",fontWeight:500},children:"Saved"})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("div",{style:{width:14,height:14,borderRadius:"50%",background:"linear-gradient(135deg, #f87171 0%, #dc2626 100%)",flexShrink:0,boxShadow:"0 2px 6px rgba(248, 113, 113, 0.4)"}}),t.jsx("span",{style:{fontSize:"0.8rem",color:"#4a5568",fontWeight:500},children:"Skipped"})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("div",{style:{width:14,height:14,borderRadius:"50%",background:"#d1d5db",flexShrink:0,border:"2px solid #9ca3af"}}),t.jsx("span",{style:{fontSize:"0.8rem",color:"#4a5568",fontWeight:500},children:"Not Visited"})]})]})]}),t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:20},children:[t.jsxs("h6",{style:{fontSize:"0.95rem",fontWeight:700,color:"#2d3748",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{width:"6px",height:"20px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"3px"}}),"Question Status"]}),b.sections.map(e=>t.jsxs("div",{className:"mb-4",children:[t.jsx("div",{style:{fontSize:"0.9rem",fontWeight:600,color:"#4a5568",marginBottom:"10px",padding:"6px 12px",background:"rgba(102, 126, 234, 0.08)",borderRadius:"8px",borderLeft:"3px solid #667eea"},children:e.section.sectionName}),t.jsx("div",{className:"d-flex flex-wrap gap-2",children:e.questions.map((n,i)=>t.jsx("div",{onClick:()=>y(`/studentAssessment/sections/${e.section.sectionId}/questions/${i}`),style:{width:32,height:32,borderRadius:"8px",background:Me(String(e.section.sectionId),n.questionnaireQuestionId),color:"#fff",fontSize:12,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:i+1},n.questionnaireQuestionId))})]},e.section.sectionId))]})]}),t.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center",alignItems:"flex-start",padding:"30px 30px 30px 20px",overflowY:"auto"},children:t.jsx("div",{className:"card",style:{width:"auto",minWidth:"900px",maxWidth:"1200px",minHeight:"auto",borderRadius:"24px",border:"none",boxShadow:"0 20px 60px rgba(0,0,0,0.15)",background:"#ffffff",colorScheme:"light",color:"#2d3748"},children:t.jsxs("div",{className:"card-body p-5",children:[t.jsx("div",{className:"mb-3",children:t.jsx("span",{style:{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%)",color:"#667eea",padding:"8px 20px",borderRadius:"30px",fontSize:"0.9rem",fontWeight:600,display:"inline-block",border:"1px solid rgba(102, 126, 234, 0.3)"},children:Se?.section?.sectionName})}),t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[t.jsxs("h6",{style:{color:"#2d3748",fontWeight:700,marginBottom:0,fontSize:"1.1rem"},children:["Question ",q+1," of ",p.length]}),O&&t.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"10px 24px",borderRadius:"30px",fontWeight:700,fontSize:"1rem",color:"white",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},children:["‚è±Ô∏è ",Ae(ie)]})]}),je&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>U(!1),children:t.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"32px 36px",maxWidth:"440px",width:"90%",textAlign:"center",boxShadow:"0 20px 60px rgba(0,0,0,0.25)",color:"#2d3748"},onClick:e=>e.stopPropagation(),children:[t.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",fontSize:"1.8rem"},children:"‚ö†Ô∏è"}),t.jsx("h5",{style:{fontWeight:700,marginBottom:"12px",color:"#1a202c",fontSize:"1.2rem"},children:"Mark all answers before saving"}),t.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",lineHeight:1.6,marginBottom:"24px"},children:"Some questions are still unanswered, saved for later, or skipped. Please answer all questions before submitting."}),t.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[t.jsx("button",{onClick:()=>U(!1),style:{background:"#e2e8f0",color:"#4a5568",border:"none",borderRadius:"10px",padding:"10px 24px",fontWeight:600,fontSize:"0.95rem",cursor:"pointer"},children:"Close"}),t.jsx("button",{onClick:Fe,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",border:"none",borderRadius:"10px",padding:"10px 24px",fontWeight:600,fontSize:"0.95rem",cursor:"pointer",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},children:"Continue ‚Üí"})]})]})}),I.length>0?t.jsx("div",{style:{display:"grid",gridTemplateColumns:I.length>1?"1fr 1px 1fr":"1fr",gap:20,marginBottom:30},children:I.map((e,n)=>t.jsxs(K.Fragment,{children:[t.jsxs("div",{children:[t.jsx("h6",{className:"fw-bold mb-3"}),t.jsx("div",{style:{fontSize:"1.2rem",lineHeight:"1.7",whiteSpace:"pre-line",color:"#1a202c",fontWeight:500},children:De(e.language.languageId)})]}),n===0&&I.length>1&&t.jsx("div",{style:{width:1,backgroundColor:"#dee2e6"}})]},e.language.languageId))}):t.jsx("h4",{className:"mb-4",style:{fontSize:"1.2rem",color:"#1a202c",fontWeight:500},children:h.question.questionText}),t.jsx("div",{className:"text-muted mb-3",children:t.jsx("small",{style:{fontSize:"1.1rem",color:"#4a5568",fontWeight:500},children:h.question.questionType==="text"||h.question.isMQTtyped===!0?t.jsxs(t.Fragment,{children:["Please type your response(s) below. You can enter up to ",t.jsx("strong",{children:h.question.maxOptionsAllowed||1})," response(s)."]}):h.question.questionType==="ranking"?t.jsxs(t.Fragment,{children:["Please rank ",t.jsx("strong",{children:h.question.maxOptionsAllowed})," option(s) in order of preference (1 = most important)."]}):h.question.maxOptionsAllowed===0?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:["You can select up to ",t.jsx("strong",{children:h.question.maxOptionsAllowed})," option(s)."]})})}),t.jsx("div",{className:"mt-4",children:(()=>{const e=h.question.options,n=h.question.questionType==="ranking";if(h.question.questionType==="text"||h.question.isMQTtyped===!0){const s=h.question.maxOptionsAllowed||1,a=$[o]?.[x]||{},c=(f,g)=>{const m=`${o}-${x}-${f}`;re(u=>({...u,[m]:g})),D.current[m]&&clearTimeout(D.current[m]),D.current[m]=setTimeout(()=>{ge(u=>({...u,[o]:{...u[o],[x]:{...u[o]?.[x]||{},[f]:g}}})),G(u=>{const S=new Set(u[o]||[]);return S.delete(x),{...u,[o]:S}}),re(u=>{const{[m]:S,...T}=u;return T})},300)},l=(f,g)=>{const m=`${o}-${x}-${f}`;D.current[m]&&clearTimeout(D.current[m]),ge(u=>({...u,[o]:{...u[o],[x]:{...u[o]?.[x]||{},[f]:g}}})),G(u=>{const S=new Set(u[o]||[]);return S.delete(x),{...u,[o]:S}}),re(u=>{const{[m]:S,...T}=u;return T}),Y(null)};return t.jsx("div",{children:Array.from({length:s},(f,g)=>{const m=`${o}-${x}-${g}`,u=xe[m]??a[g]??"",S=u.toLowerCase(),T=u.trim().toLowerCase(),v=e.filter(Q=>{const W=Q.optionText?.toLowerCase()||"";return Object.entries(a).some(([J,Ve])=>Number(J)!==g&&Ve.trim().toLowerCase()===W)?!1:S.length<4?!0:W.includes(S)}),R=Ce===`${x}-${g}`&&v.length>0,le=v.length===1&&v[0].optionText?.toLowerCase()===T;return t.jsxs("div",{className:"mb-3",style:{position:"relative"},children:[t.jsxs("label",{className:"fw-bold mb-1",style:{fontSize:"1rem",color:"#4a5568"},children:["Response ",g+1,":"]}),t.jsx("input",{type:"text",className:"form-control form-control-lg",placeholder:"Type your answer...",value:xe[m]??a[g]??"",onChange:Q=>{c(g,Q.target.value),Y(`${x}-${g}`)},onFocus:()=>Y(`${x}-${g}`),onBlur:()=>setTimeout(()=>Y(null),200),autoComplete:"off",style:{fontSize:"1.1rem",padding:"12px 16px",borderColor:"#dee2e6"}}),R&&!le&&t.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"#fff",border:"1px solid #e2e8f0",borderTop:"none",borderRadius:"0 0 8px 8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",maxHeight:"240px",overflowY:"auto"},children:v.map(Q=>{const W=Q.optionText||"",B=W.toLowerCase().indexOf(S);return t.jsx("div",{onMouseDown:()=>l(g,W),style:{padding:"10px 16px",cursor:"pointer",fontSize:"1rem",borderBottom:"1px solid #f1f5f9",transition:"background 0.15s"},onMouseEnter:J=>J.currentTarget.style.background="#f7fafc",onMouseLeave:J=>J.currentTarget.style.background="#fff",children:B>=0?t.jsxs(t.Fragment,{children:[W.slice(0,B),t.jsx("strong",{children:W.slice(B,B+S.length)}),W.slice(B+S.length)]}):W},Q.optionId)})})]},g)})})}const r=(s,a)=>{if(s.isGame&&s.game)return t.jsx("div",{className:"rounded p-4 mb-3",style:{border:"1px solid #dee2e6",background:"#faf5ff"},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"font-bold text-purple-900 mb-2",style:{fontSize:"1.1rem",color:"#2d3748"},children:["üéÆ Game: ",s.game.gameName]}),I.length>0?t.jsx("div",{style:{display:"grid",gridTemplateColumns:I.length>1?"1fr 1px 1fr":"1fr",gap:15},children:I.map((c,l)=>t.jsxs(K.Fragment,{children:[t.jsx("div",{style:{fontSize:"1.2rem",lineHeight:"1.6",color:"#2d3748"},children:V(s,c.language.languageId)}),l===0&&I.length>1&&t.jsx("div",{style:{width:1,backgroundColor:"#dee2e6"}})]},c.language.languageId))}):t.jsx("span",{style:{fontSize:"1.2rem",color:"#2d3748"},children:s.optionText})]}),t.jsx("button",{onClick:()=>He(s.game.gameCode),style:{marginLeft:"16px",background:C.includes(s.optionId)||s.game&&E[s.game.gameCode]?"linear-gradient(to right, #22c55e, #16a34a)":"linear-gradient(to right, #8b5cf6, #d946ef)",color:"white",padding:"12px 24px",borderRadius:"9999px",fontWeight:700,fontSize:"14px",border:"none",cursor:C.includes(s.optionId)||s.game&&E[s.game.gameCode]?"default":"pointer",boxShadow:"0 4px 15px rgba(139, 92, 246, 0.4)",transition:"all 0.2s ease",opacity:C.includes(s.optionId)||s.game&&E[s.game.gameCode]?.8:1},disabled:C.includes(s.optionId)||s.game&&E[s.game.gameCode],children:C.includes(s.optionId)||s.game&&E[s.game.gameCode]?"‚úì Completed":"üéÆ Launch Game"})]})},s.optionId);if(n){const c=N[o]?.[x]?.[s.optionId],l=Ee(s.optionId);return t.jsxs("div",{className:"rounded p-3 d-block mb-2",style:{display:"flex",alignItems:"center",gap:"15px",background:c?"#f8f9fa":"#fff",border:"1px solid #dee2e6"},children:[t.jsx("div",{style:{minWidth:"120px"},children:t.jsxs("select",{className:"form-select form-select-sm",value:c||"",onChange:f=>{const g=f.target.value;We(s.optionId,g?parseInt(g):null)},style:{width:"110px",fontSize:"1rem",fontWeight:600,color:"#2d3748",background:"#fff",borderColor:"#dee2e6"},children:[t.jsx("option",{value:"",children:"Rank"}),c&&!l.includes(c)?t.jsx("option",{value:c,children:c}):null,l.map(f=>t.jsx("option",{value:f,children:f},f))]})}),t.jsx("div",{style:{flex:1},children:ae(s)?pe(s):I.length>0?t.jsx("div",{style:{display:"grid",gridTemplateColumns:I.length>1?"1fr 1px 1fr":"1fr",gap:15},children:I.map((f,g)=>t.jsxs(K.Fragment,{children:[t.jsx("div",{style:{fontSize:"1.2rem",lineHeight:"1.6",color:"#2d3748"},children:V(s,f.language.languageId)}),g===0&&I.length>1&&t.jsx("div",{style:{width:1,backgroundColor:"#dee2e6"}})]},f.language.languageId))}):t.jsx("span",{style:{fontSize:"1.2rem",color:"#2d3748"},children:s.optionText})})]},s.optionId)}return t.jsx("label",{className:"rounded p-3 d-block mb-2",style:{cursor:"pointer",background:C.includes(s.optionId)?"#f8f9fa":"#fff",border:"1px solid #dee2e6"},children:t.jsxs("div",{className:"d-flex align-items-start",children:[t.jsx("input",{type:"checkbox",className:"me-3 mt-1",checked:C.includes(s.optionId),onChange:()=>$e(s.optionId),disabled:h.question.maxOptionsAllowed>0&&!C.includes(s.optionId)&&C.length>=h.question.maxOptionsAllowed}),t.jsxs("div",{style:{flex:1},children:[ae(s)?t.jsx("div",{children:pe(s)}):I.length>0?t.jsx("div",{style:{display:"grid",gridTemplateColumns:I.length>1?"1fr 1px 1fr":"1fr",gap:15},children:I.map((c,l)=>t.jsxs(K.Fragment,{children:[t.jsx("div",{style:{fontSize:"1.2rem",lineHeight:"1.6",color:"#2d3748"},children:V(s,c.language.languageId)}),l===0&&I.length>1&&t.jsx("div",{style:{width:1,backgroundColor:"#dee2e6"}})]},c.language.languageId))}):t.jsx("span",{style:{fontSize:"1.2rem",color:"#2d3748"},children:s.optionText}),Je(s)]})]})},s.optionId)};if(e.length>5){const s=Math.ceil(e.length/2),a=e.slice(0,s),c=e.slice(s);return t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px"},children:[t.jsx("div",{children:a.map((l,f)=>r(l))}),t.jsx("div",{children:c.map((l,f)=>r(l))})]})}return e.map((s,a)=>r(s))})()}),t.jsxs("div",{className:"d-flex justify-content-between mt-5 pt-3",style:{borderTop:"1px solid #e2e8f0"},children:[t.jsx("button",{disabled:q===0,onClick:Qe,style:{background:q===0?"#e2e8f0":"white",color:q===0?"#9ca3af":"#4a5568",border:"2px solid #e2e8f0",borderRadius:"12px",padding:"12px 28px",fontWeight:600,fontSize:"0.95rem",cursor:q===0?"not-allowed":"pointer",transition:"all 0.2s ease"},children:"‚Üê Back"}),t.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[t.jsx("button",{onClick:Le,style:{background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",color:"#78350f",border:"none",borderRadius:"12px",padding:"12px 24px",fontWeight:600,fontSize:"0.95rem",cursor:"pointer",boxShadow:"0 4px 15px rgba(251, 191, 36, 0.4)",transition:"all 0.2s ease"},children:"Save for Later"}),!fe()&&t.jsx("button",{onClick:Ge,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"12px",padding:"12px 32px",fontWeight:600,fontSize:"0.95rem",cursor:"pointer",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)",transition:"all 0.2s ease"},children:q===p.length-1?"NEXT SECTION ‚Üí":"NEXT ‚Üí"}),(fe()||me())&&t.jsx("button",{onClick:Pe,style:{background:"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)",color:"white",border:"none",borderRadius:"12px",padding:"12px 32px",fontWeight:700,fontSize:"1rem",cursor:"pointer",boxShadow:"0 4px 15px rgba(34, 197, 94, 0.4)",transition:"all 0.2s ease",marginLeft:"auto"},children:"‚úì SUBMIT ASSESSMENT"})]})]})]})})})]})};export{ut as default};
