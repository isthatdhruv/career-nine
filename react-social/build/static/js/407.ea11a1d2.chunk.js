"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[407,94],{64407:(e,s,l)=>{l.r(s),l.d(s,{default:()=>E});var t=l(72791),a=l(16871),n=l(43360),i=l(89983),d=l(16856),o=l(54624),r=l(575),c=l(33489),m=l(78820),u=l(43504),h=l(70099),x=l(10120),p=l(88777),b=l(62094),g=l(1413),v=l(28403),j=l(7755),N=l(43677),f=l(51304),y=l(80184);const w=e=>{var s;const[l,a]=(0,t.useState)(!1),[n,i]=(0,t.useState)([]),[d,r]=(0,t.useState)([]),[c,m]=(0,t.useState)(!1),[u,x]=(0,t.useState)([]),[p,b]=(0,t.useState)([]),[w,C]=(0,t.useState)(!1),[k,S]=(0,t.useState)(null);(0,t.useEffect)(()=>{var s,l;if(!e.show)return;if((async()=>{try{var s,l,t,a,n,d,o;const c=await(0,f.Fk)(),m=(null!==(s=null!==(l=null!==(t=null===c||void 0===c||null===(a=c.data)||void 0===a?void 0:a.data)&&void 0!==t?t:null===c||void 0===c||null===(n=c.data)||void 0===n?void 0:n.contacts)&&void 0!==l?l:null===c||void 0===c?void 0:c.data)&&void 0!==s?s:[]).filter(e=>e&&(e.name||e.email||e.phone||e.designation));i(m);const u=null!==(d=null===(o=e.data)||void 0===o?void 0:o.contactPersons)&&void 0!==d?d:[],h=[];m.forEach((e,s)=>{u.find(s=>s.id&&e.id&&s.id===e.id||s.email&&e.email&&s.email===e.email)&&h.push(s)}),r(h)}catch(c){console.error("Failed to load contacts:",c),i([]),r([])}})(),(async()=>{try{var e,s,l,t,a;const n=await(0,N.AF)(),i=(null!==(e=null!==(s=null!==(l=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.data)&&void 0!==l?l:null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.boards)&&void 0!==s?s:null===n||void 0===n?void 0:n.data)&&void 0!==e?e:[]).filter(e=>e&&("string"===typeof e.boardName||"string"===typeof e.name||"undefined"!==typeof e.id));x(i),b([])}catch(n){console.error("Failed to load boards:",n),x([])}})(),void 0!==(null===(s=e.data)||void 0===s?void 0:s.maxClass)&&null!==(null===(l=e.data)||void 0===l?void 0:l.maxClass)){const s=Number(e.data.maxClass);!isNaN(s)&&s>=1&&s<=12?S(s):S(null)}else S(null)},[e.show,e.data]);const Z=e=>d.includes(e),P=e=>p.includes(e),A=e=>{if(""===e)return void S(null);let s=Number(e);isNaN(s)||(s<1&&(s=1),s>12&&(s=12),S(s))},H=e=>{var s,l;return null!==(s=null!==(l=e.boardName)&&void 0!==l?l:e.name)&&void 0!==s?s:void 0!==e.id?String(e.id):"Board"},F=d.map(e=>n[e]),E=p.map(e=>u[e]),z=d.length>0;return(0,y.jsxs)(v.Z,{show:e.show,onHide:()=>e.onHide(),centered:!0,className:"college-modal","aria-labelledby":"college-info-modal-title",children:[(0,y.jsxs)(v.Z.Header,{className:"border-0 pb-0",children:[(0,y.jsxs)("div",{className:"d-flex flex-column",children:[(0,y.jsx)("h3",{id:"college-info-modal-title",className:"mb-1 fw-bold",children:"Map Board & Contact Person(s)"}),(0,y.jsx)("span",{className:"text-muted small",children:"Link the institute with appropriate contact person(s), board(s) and max class."})]}),(0,y.jsx)("div",{className:"btn btn-sm btn-icon btn-light ms-3",onClick:()=>e.onHide(),style:{cursor:"pointer"},children:(0,y.jsx)(h.Z,{animation:j.Z,size:24,strokeColor:"#181C32",reverse:!0})})]}),(0,y.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),!e.data)return void e.onHide();const l=d.map(e=>n[e]),t=p.map(e=>u[e]);a(!0);try{const s=(0,g.Z)((0,g.Z)({},e.data),{},{contactPersons:l});t.length>0&&(s.boards=t),null!==k&&(s.maxClass=k),await(0,o.J6)(s),e.setPageLoading(["true"]),e.onHide(!1)}catch(i){console.error("UpdateCollegeData failed",i),window.location.replace("/error")}finally{a(!1)}},className:"form w-100",children:[(0,y.jsx)(v.Z.Body,{className:"pt-3",children:(0,y.jsxs)("div",{className:"d-flex flex-column gap-4",children:[(0,y.jsx)("div",{className:"card shadow-sm border-0",children:(0,y.jsxs)("div",{className:"card-body",children:[(0,y.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"badge bg-light text-dark mb-1",children:"Step 1"}),(0,y.jsx)("h5",{className:"mb-0",children:"Select Contact Person(s)"}),(0,y.jsx)("small",{className:"text-muted",children:"Choose one or more contact persons associated with this institute."})]}),n.length>0&&(0,y.jsxs)("span",{className:"badge bg-success-subtle text-success",children:[d.length," selected"]})]}),(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsxs)("button",{type:"button",className:"btn btn-outline-success dropdown-toggle d-flex align-items-center px-3 py-2",onClick:()=>m(e=>!e),children:[(0,y.jsx)("span",{className:"me-2",children:"\ud83d\udc64"}),(0,y.jsx)("span",{children:d.length>0?"Edit selected contact person(s)":"Select contact person(s)"})]}),(0,y.jsx)("div",{className:"dropdown-menu mt-2 shadow-sm border-0 ".concat(c?"show":""),style:{maxHeight:"260px",overflowY:"auto",minWidth:"320px"},children:0===n.length?(0,y.jsx)("span",{className:"dropdown-item-text text-muted fst-italic",children:"No contact persons found."}):n.map((e,s)=>{var l;const t=(e.name||"").split(" ").map(e=>e[0]).join("").toUpperCase()||"?";return(0,y.jsxs)("label",{className:"dropdown-item d-flex align-items-start py-2",style:{cursor:"pointer"},children:[(0,y.jsx)("input",{type:"checkbox",className:"form-check-input me-3 mt-1",checked:Z(s),onChange:()=>(e=>{r(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])})(s)}),(0,y.jsxs)("div",{className:"d-flex align-items-start w-100",children:[(0,y.jsx)("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:32,height:32,background:"#eef3ff",fontSize:13,fontWeight:600},children:t}),(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"fw-semibold",children:e.name||"Unnamed Contact"}),(0,y.jsxs)("div",{className:"text-muted small",children:[e.email&&(0,y.jsx)("span",{children:e.email}),e.phone&&(0,y.jsxs)("span",{children:[" ",e.email?" \u2022 ":"",e.phone]})]}),(e.gender||e.designation)&&(0,y.jsx)("div",{className:"small text-muted",children:[e.gender,e.designation].filter(Boolean).join(" \u2022 ")})]})]})]},null!==(l=e.id)&&void 0!==l?l:"".concat(e.email,"-").concat(s))})})]}),F.length>0&&(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"text-muted small mb-1",children:"Selected contact(s):"}),(0,y.jsx)("div",{className:"d-flex flex-wrap gap-2",children:F.map((e,s)=>{var l;return(0,y.jsxs)("span",{className:"badge bg-light text-dark border",children:[e.name||"Unnamed Contact",e.designation&&(0,y.jsxs)("span",{className:"text-muted ms-1 small",children:["(",e.designation,")"]})]},null!==(l=e.id)&&void 0!==l?l:"".concat(e.email,"-chip-").concat(s))})})]})]})}),(0,y.jsx)("div",{className:"card shadow-sm border-0 ".concat(z?"":"opacity-75"),children:(0,y.jsxs)("div",{className:"card-body",children:[(0,y.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"badge bg-light text-dark mb-1",children:"Step 2"}),(0,y.jsx)("h5",{className:"mb-0",children:"Select Board(s)"}),(0,y.jsxs)("small",{className:"text-muted",children:["Map this institute to one or more education boards.",!z&&(0,y.jsx)("span",{className:"text-danger ms-1",children:"(Select at least one contact person in Step 1 first)"})]})]}),u.length>0&&z&&(0,y.jsxs)("span",{className:"badge bg-primary-subtle text-primary",children:[p.length," selected"]})]}),(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsxs)("button",{type:"button",className:"btn btn-outline-primary dropdown-toggle d-flex align-items-center px-3 py-2",onClick:()=>{z&&C(e=>!e)},disabled:!z,children:[(0,y.jsx)("span",{className:"me-2",children:"\ud83d\udccb"}),(0,y.jsx)("span",{children:p.length>0?"Edit selected board(s)":"Select board(s)"})]}),(0,y.jsx)("div",{className:"dropdown-menu mt-2 shadow-sm border-0 ".concat(w&&z?"show":""),style:{maxHeight:"260px",overflowY:"auto",minWidth:"260px"},children:z?0===u.length?(0,y.jsx)("span",{className:"dropdown-item-text text-muted fst-italic",children:"No boards found."}):u.map((e,s)=>{const l=H(e);return(0,y.jsxs)("label",{className:"dropdown-item d-flex align-items-center py-2",style:{cursor:"pointer"},children:[(0,y.jsx)("input",{type:"checkbox",className:"form-check-input me-3",checked:P(s),onChange:()=>(e=>{b(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])})(s)}),(0,y.jsx)("span",{className:"fw-semibold",children:l})]},"".concat(l,"-").concat(s))}):(0,y.jsx)("span",{className:"dropdown-item-text text-muted fst-italic",children:"Please select contact person(s) in Step 1 first."})})]}),z&&E.length>0&&(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"text-muted small mb-1",children:"Selected board(s):"}),(0,y.jsx)("div",{className:"d-flex flex-wrap gap-2",children:E.map((e,s)=>(0,y.jsx)("span",{className:"badge bg-light text-dark border",children:H(e)},"".concat(H(e),"-chip-").concat(s)))})]})]})}),(0,y.jsx)("div",{className:"card shadow-sm border-0",children:(0,y.jsxs)("div",{className:"card-body",children:[(0,y.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"badge bg-light text-dark mb-1",children:"Step 3"}),(0,y.jsx)("h5",{className:"mb-0",children:"Max Class"}),(0,y.jsx)("small",{className:"text-muted",children:"Set the maximum class for which this institute is applicable (1\u201312)."})]}),null!==k&&(0,y.jsxs)("span",{className:"badge bg-info-subtle text-info",children:["Class ",k]})]}),(0,y.jsx)("div",{className:"mt-3",children:(0,y.jsxs)("div",{className:"d-flex align-items-center gap-3 flex-wrap",children:[(0,y.jsxs)("div",{className:"flex-grow-1",children:[(0,y.jsx)("input",{type:"range",className:"form-range",min:1,max:12,step:1,value:null!==k&&void 0!==k?k:1,onChange:e=>A(e.target.value)}),(0,y.jsxs)("div",{className:"d-flex justify-content-between text-muted small mt-1",children:[(0,y.jsx)("span",{children:"1"}),(0,y.jsx)("span",{children:"12"})]})]}),(0,y.jsxs)("div",{style:{minWidth:90},children:[(0,y.jsx)("label",{className:"form-label mb-1 small text-muted",children:"Max Class"}),(0,y.jsx)("input",{type:"number",className:"form-control form-control-sm",min:1,max:12,value:null!==k&&void 0!==k?k:"",placeholder:"1\u201312",onChange:e=>A(e.target.value)})]})]})})]})})]})}),(0,y.jsx)(v.Z.Footer,{className:"border-0 pt-0",children:(0,y.jsxs)("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[(0,y.jsx)("div",{className:"text-muted small",children:(null===(s=e.data)||void 0===s?void 0:s.instituteCode)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{className:"fw-semibold",children:"Institute Code: "}),(0,y.jsx)("span",{children:e.data.instituteCode})]})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-light me-2",onClick:()=>e.onHide(),disabled:l,children:"Cancel"}),(0,y.jsxs)("button",{type:"submit",className:"btn btn-sm btn-primary",disabled:l||0===n.length&&0===u.length,children:[!l&&(0,y.jsx)("span",{className:"indicator-label",children:"Save Selection"}),l&&(0,y.jsxs)("span",{className:"indicator-progress",style:{display:"block"},children:["Please wait...",(0,y.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})]})})]})]})};var C=l(94552);const k=["Principal","Administrator","Coordinator","Teacher","Accountant","Counselor"],S=e=>{var s;const[l,a]=(0,t.useState)(!1),[n,i]=(0,t.useState)([]),[d,r]=(0,t.useState)([]),[c,m]=(0,t.useState)({}),[u,x]=(0,t.useState)({}),[p,b]=(0,t.useState)([]),[w,S]=(0,t.useState)([]),[Z,P]=(0,t.useState)(!1),[A,H]=(0,t.useState)(k),[F,E]=(0,t.useState)(!1);(0,t.useEffect)(()=>{if(!e.show)return;(async()=>{try{var s,l,t,a,n,d,o;const c=await(0,f.Fk)(),m=(null!==(s=null!==(l=null!==(t=null===c||void 0===c||null===(a=c.data)||void 0===a?void 0:a.data)&&void 0!==t?t:null===c||void 0===c||null===(n=c.data)||void 0===n?void 0:n.contacts)&&void 0!==l?l:null===c||void 0===c?void 0:c.data)&&void 0!==s?s:[]).filter(e=>e&&(e.name||e.email||e.phone||e.designation));i(m);const u=null!==(d=null===(o=e.data)||void 0===o?void 0:o.contactPersons)&&void 0!==d?d:[],h=[];m.forEach((e,s)=>{u.find(s=>s.id&&e.id&&s.id===e.id||s.email&&e.email&&s.email===e.email)&&h.push(s)}),r(h)}catch(c){console.error("Failed to load contacts:",c),i([]),r([])}})(),(async()=>{try{var e,s,l,t,a;const n=await(0,N.AF)(),i=(null!==(e=null!==(s=null!==(l=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.data)&&void 0!==l?l:null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.boards)&&void 0!==s?s:null===n||void 0===n?void 0:n.data)&&void 0!==e?e:[]).filter(e=>e&&("string"===typeof e.boardName||"string"===typeof e.name||"undefined"!==typeof e.id));b(i),S([])}catch(n){console.error("Failed to load boards:",n),b([])}})(),(async()=>{E(!0);try{var e,s,l,t,a;const n=await(0,C.tu)(),i=((null!==(e=null!==(s=null!==(l=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.data)&&void 0!==l?l:null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.roles)&&void 0!==s?s:null===n||void 0===n?void 0:n.data)&&void 0!==e?e:[])||[]).map(e=>{return e||0===e?"string"===typeof e?e:"object"===typeof e&&null!==(s=null!==(l=null!==(t=null!==(a=null!==(n=e.role)&&void 0!==n?n:e.name)&&void 0!==a?a:e.roleName)&&void 0!==t?t:e.title)&&void 0!==l?l:e.label)&&void 0!==s?s:null:null;var s,l,t,a,n}).filter(Boolean);i.length>0?H(i):H(k)}catch(n){console.error("Failed to load roles:",n),H(k)}finally{E(!1)}})()},[e.show,e.data]),(0,t.useEffect)(()=>{const s={};d.forEach(l=>{var t,a;const i=n[l];let d;if(null!==(t=e.data)&&void 0!==t&&null!==(a=t.contactPersons)&&void 0!==a&&a.length){const s=e.data.contactPersons.find(e=>e.id&&(null===i||void 0===i?void 0:i.id)&&e.id===i.id||e.email&&(null===i||void 0===i?void 0:i.email)&&e.email===i.email);d=null===s||void 0===s?void 0:s.roles}s[l]=d&&Array.isArray(d)?d:[]}),x(e=>(0,g.Z)((0,g.Z)({},s),e)),m({})},[n,d,e.data]);const z=e=>{r(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]),x(s=>{const l=(0,g.Z)({},s);return l[e]&&delete l[e],l}),m(s=>{const l=(0,g.Z)({},s);return l[e]&&delete l[e],l})},I=e=>d.includes(e),L=e=>{m(s=>(0,g.Z)((0,g.Z)({},s),{},{[e]:!s[e]}))};d.map(e=>n[e]),w.map(e=>p[e]),d.length;return(0,y.jsxs)(v.Z,{show:e.show,onHide:()=>e.onHide(),centered:!0,className:"college-modal",dialogClassName:"college-modal-dialog","aria-labelledby":"college-info-modal-title",children:[(0,y.jsx)("style",{children:"\n        /* Make the modal wider and responsive */\n        .college-modal .modal-dialog {\n          max-width: 1200px;      /* increase as needed */\n          width: 95vw;\n        }\n        /* Ensure modal body doesn't force horizontal scroll */\n        .college-modal .modal-body {\n          overflow-x: hidden;\n        }\n\n        /* Let tables auto-layout and wrap cells instead of creating horizontal scroll */\n        .college-modal .table-responsive {\n          overflow-x: visible !important;\n        }\n        .college-modal table {\n          table-layout: auto;\n          width: 100%;\n        }\n        .college-modal th, .college-modal td {\n          white-space: normal;\n          word-wrap: break-word;\n          vertical-align: middle;\n        }\n\n        /* Make role badges wrap to next line when space is insufficient */\n        .college-modal .badge {\n          white-space: nowrap;\n          margin-bottom: 4px;\n        }\n\n        /* Ensure the per-contact dropdown doesn't push layout horizontally */\n        .college-modal .card.position-absolute {\n          left: 0;\n          right: auto;\n          max-width: 420px;\n        }\n\n        /* Small screens fallback */\n        @media (max-width: 768px) {\n          .college-modal .modal-dialog {\n            max-width: 100%;\n            width: 98vw;\n          }\n        }\n      "}),(0,y.jsxs)(v.Z.Header,{className:"border-0 pb-0",children:[(0,y.jsxs)("div",{className:"d-flex flex-column",children:[(0,y.jsx)("h3",{id:"college-info-modal-title",className:"mb-1 fw-bold",children:"Assign Roles"}),(0,y.jsx)("span",{className:"text-muted small",children:"Assign roles to the selected contact person"})]}),(0,y.jsx)("div",{className:"btn btn-sm btn-icon btn-light ms-3",onClick:()=>e.onHide(),style:{cursor:"pointer"},children:(0,y.jsx)(h.Z,{animation:j.Z,size:24,strokeColor:"#181C32",reverse:!0})})]}),(0,y.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),!e.data)return void e.onHide();const l=d.map(e=>{var s;const l=n[e],t=null!==(s=u[e])&&void 0!==s?s:[];return(0,g.Z)((0,g.Z)({},l),{},{roles:t})}),t=w.map(e=>p[e]);a(!0);try{const s=(0,g.Z)((0,g.Z)({},e.data),{},{contactPersons:l});t.length>0&&(s.boards=t),await(0,o.J6)(s),e.setPageLoading(["true"]),e.onHide(!1)}catch(i){console.error("UpdateCollegeData failed",i),window.location.replace("/error")}finally{a(!1)}},className:"form w-100",children:[(0,y.jsx)(v.Z.Body,{className:"pt-3",children:(0,y.jsx)("div",{className:"d-flex flex-column gap-4",children:(0,y.jsx)("div",{className:"card shadow-sm border-0",children:(0,y.jsxs)("div",{className:"card-body",children:[(0,y.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:(0,y.jsxs)("div",{children:[(0,y.jsx)("h5",{className:"mb-0",children:"Selected Contact Person"}),(0,y.jsx)("small",{className:"text-muted",children:"Choose one or more roles associated with the contact person."})]})}),(0,y.jsx)("div",{className:"mt-3",children:0===n.length?(0,y.jsx)("div",{className:"text-muted small",children:"No contacts available"}):(0,y.jsx)("div",{className:"list-group",children:n.map((e,s)=>{var l,t,a,n;return(0,y.jsxs)("label",{className:"list-group-item d-flex justify-content-between align-items-center ".concat(I(s)?"active":""),style:{cursor:"pointer"},children:[(0,y.jsxs)("div",{className:"form-check",children:[(0,y.jsx)("input",{className:"form-check-input me-2",type:"checkbox",checked:I(s),onChange:()=>z(s)}),(0,y.jsx)("span",{className:"fw-semibold",children:null!==(l=null!==(t=null!==(a=e.name)&&void 0!==a?a:e.email)&&void 0!==t?t:e.phone)&&void 0!==l?l:"Unnamed"}),(0,y.jsxs)("div",{className:"small text-muted",children:[e.designation?"".concat(e.designation," \u2022 "):"",null!==(n=e.email)&&void 0!==n?n:e.phone]})]}),(0,y.jsx)("div",{children:(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:e=>{e.stopPropagation(),I(s)||z(s),L(s)},children:"Roles"})})]},s)})})}),(0,y.jsxs)("div",{className:"mt-4",children:[(0,y.jsx)("h6",{className:"mb-2",children:"Selected Contacts & Roles"}),0===d.length?(0,y.jsx)("div",{className:"text-muted small",children:"No contact selected yet."}):(0,y.jsx)("div",{className:"table-responsive",children:(0,y.jsxs)("table",{className:"table table-hover align-middle",children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{style:{width:"35%"},children:"Contact"}),(0,y.jsx)("th",{style:{width:"50%"},children:"Assigned Roles"}),(0,y.jsx)("th",{style:{width:"15%"},children:"Actions"})]})}),(0,y.jsx)("tbody",{children:d.map(e=>{var s,l,t,a,i;const d=n[e],o=null!==(s=u[e])&&void 0!==s?s:[],r=!!c[e];return(0,y.jsxs)("tr",{children:[(0,y.jsxs)("td",{children:[(0,y.jsx)("div",{className:"fw-semibold",children:null!==(l=null!==(t=null!==(a=d.name)&&void 0!==a?a:d.email)&&void 0!==t?t:d.phone)&&void 0!==l?l:"Unnamed"}),(0,y.jsxs)("div",{className:"small text-muted",children:[null!==(i=d.designation)&&void 0!==i?i:"",d.email?" \u2022 ".concat(d.email):""]})]}),(0,y.jsxs)("td",{children:[(0,y.jsx)("div",{className:"d-flex flex-wrap gap-2",children:0===o.length?(0,y.jsx)("span",{className:"small text-muted",children:"No roles assigned"}):o.map(s=>(0,y.jsxs)("span",{className:"badge bg-light text-dark border d-inline-flex align-items-center",style:{padding:"0.45rem 0.6rem"},children:[(0,y.jsx)("span",{className:"me-2 small",children:s}),(0,y.jsx)("button",{type:"button","aria-label":"Remove ".concat(s),className:"btn btn-sm btn-icon btn-light btn-xs",onClick:()=>{return l=e,t=s,void x(e=>{var s;const a=null!==(s=e[l])&&void 0!==s?s:[];return(0,g.Z)((0,g.Z)({},e),{},{[l]:a.filter(e=>e!==t)})});var l,t},style:{border:"none",padding:"0",margin:"0",lineHeight:1,cursor:"pointer"},children:(0,y.jsx)("span",{style:{fontSize:14,marginLeft:4},children:"\xd7"})})]},s))}),(0,y.jsx)("div",{className:"position-relative mt-2",children:r&&(0,y.jsxs)("div",{className:"card shadow-sm position-absolute",style:{zIndex:1200,left:0,top:0,minWidth:260,padding:12},onClick:e=>e.stopPropagation(),children:[(0,y.jsx)("div",{className:"fw-semibold mb-2",children:"Select Roles"}),F?(0,y.jsx)("div",{className:"small text-muted",children:"Loading roles..."}):(0,y.jsx)("div",{className:"roles-list",style:{maxHeight:220,overflow:"auto"},children:A.map(s=>{var l;const t=(null!==(l=u[e])&&void 0!==l?l:[]).includes(s);return(0,y.jsxs)("div",{className:"form-check mb-1",children:[(0,y.jsx)("input",{className:"form-check-input",type:"checkbox",id:"contact-".concat(e,"-role-").concat(s),checked:t,onChange:l=>((e,s,l)=>{x(t=>{var a;const n=null!==(a=t[e])&&void 0!==a?a:[];return l?n.includes(s)?t:(0,g.Z)((0,g.Z)({},t),{},{[e]:[...n,s]}):(0,g.Z)((0,g.Z)({},t),{},{[e]:n.filter(e=>e!==s)})})})(e,s,l.target.checked)}),(0,y.jsx)("label",{className:"form-check-label ms-2",htmlFor:"contact-".concat(e,"-role-").concat(s),style:{cursor:"pointer"},children:s})]},s)})}),(0,y.jsxs)("div",{className:"d-flex justify-content-end mt-2",children:[(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary me-2",onClick:()=>m(s=>(0,g.Z)((0,g.Z)({},s),{},{[e]:!1})),children:"Done"}),(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>x(s=>(0,g.Z)((0,g.Z)({},s),{},{[e]:[]})),children:"Clear"})]})]})})]}),(0,y.jsx)("td",{children:(0,y.jsxs)("div",{className:"d-flex gap-2",children:[(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>L(e),children:r?"Close":"Edit"}),(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>z(e),children:"Remove"})]})})]},e)})})]})})]})]})})})}),(0,y.jsx)(v.Z.Footer,{className:"border-0 pt-0",children:(0,y.jsxs)("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[(0,y.jsx)("div",{className:"text-muted small",children:(null===(s=e.data)||void 0===s?void 0:s.instituteCode)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{className:"fw-semibold",children:"Institute Code: "}),(0,y.jsx)("span",{children:e.data.instituteCode})]})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-light me-2",onClick:()=>e.onHide(),disabled:l,children:"Cancel"}),(0,y.jsxs)("button",{type:"submit",className:"btn btn-sm btn-primary",disabled:l||0===n.length&&0===p.length,children:[!l&&(0,y.jsx)("span",{className:"indicator-label",children:"Save Selection"}),l&&(0,y.jsxs)("span",{className:"indicator-progress",style:{display:"block"},children:["Please wait...",(0,y.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})]})})]})]})},Z=e=>{var s,l,a,n,i;const[d,r]=(0,t.useState)(!1),[c,m]=(0,t.useState)(!1),[u,x]=(0,t.useState)(!1),[p,b]=(0,t.useState)(!1),[g,N]=(0,t.useState)([]),[f,w]=(0,t.useState)(""),[C,k]=(0,t.useState)(""),[S,Z]=(0,t.useState)(""),[P,A]=(0,t.useState)(null),[H,F]=(0,t.useState)(null);(0,t.useEffect)(()=>{e.show&&(N([]),w(""),k(""),Z(""),A(null),F(null),m(!1),x(!1),b(!1))},[e.show,null===(s=e.data)||void 0===s?void 0:s.instituteCode]);const E=()=>{if(f.trim()){g.some(e=>e.sessionName===f.trim())||(N([...g,{sessionName:f.trim(),grades:[]}]),w(""))}},z=()=>{if(null!==P&&C.trim()){const e=[...g],s=e[P];s.grades.some(e=>e.gradeName===C.trim())||(s.grades.push({gradeName:C.trim(),sections:[]}),N(e),k(""))}},I=()=>{if(null!==P&&null!==H&&S.trim()){const e=[...g],s=e[P].grades[H];s.sections.includes(S.trim())||(s.sections.push(S.trim()),N(e),Z(""))}},L=()=>{var e;return null!==P?null===(e=g[P])||void 0===e?void 0:e.sessionName:null},U=()=>{var e,s;return null!==P&&null!==H?null===(e=g[P])||void 0===e||null===(s=e.grades[H])||void 0===s?void 0:s.gradeName:null},D=()=>{var e,s;return null!==P&&null!==H&&(null===(e=g[P])||void 0===e||null===(s=e.grades[H])||void 0===s?void 0:s.sections)||[]};return(0,y.jsxs)(v.Z,{show:e.show,onHide:()=>e.onHide(),centered:!0,size:"xl",className:"college-modal","aria-labelledby":"college-detail-modal-title",style:{maxHeight:"90vh"},children:[(0,y.jsx)("style",{children:"\n        .college-modal .modal-dialog {\n          max-width: 1200px;\n          height: 85vh;\n        }\n        \n        .college-modal .modal-content {\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n        }\n        \n        .college-modal .modal-body {\n          flex: 1;\n          overflow-y: auto;\n          max-height: calc(85vh - 180px);\n        }\n        \n        .college-modal .dropdown-menu {\n          max-height: 350px;\n        }\n      "}),(0,y.jsxs)(v.Z.Header,{className:"border-0 pb-0",children:[(0,y.jsxs)("div",{className:"d-flex flex-column",children:[(0,y.jsx)("h3",{id:"college-detail-modal-title",className:"mb-1 fw-bold",children:"Institute Details"}),(0,y.jsxs)("span",{className:"text-muted small",children:[(null===(l=e.data)||void 0===l?void 0:l.instituteName)&&(0,y.jsx)("span",{className:"fw-semibold me-2",children:e.data.instituteName}),"Manage institute information, mappings, and configurations"]})]}),(0,y.jsx)("div",{className:"btn btn-sm btn-icon btn-light ms-3",onClick:()=>e.onHide(),style:{cursor:"pointer"},children:(0,y.jsx)(h.Z,{animation:j.Z,size:24,strokeColor:"#181C32",reverse:!0})})]}),(0,y.jsxs)("div",{className:"form w-100",children:[(0,y.jsx)(v.Z.Body,{className:"pt-3",children:(0,y.jsx)("div",{className:"d-flex flex-column gap-4",children:(0,y.jsx)("div",{className:"card shadow-sm border-0",style:{background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",minHeight:"500px"},children:(0,y.jsxs)("div",{className:"card-body",style:{minHeight:"480px"},children:[(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsx)("h5",{className:"mb-1 fw-semibold",children:"Quick Actions"}),(0,y.jsx)("small",{className:"text-muted",children:"Add sessions, grades, and sections for this institute"})]}),(0,y.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,y.jsxs)("div",{className:"position-relative",children:[(0,y.jsx)("button",{type:"button",className:"btn btn-primary dropdown-toggle d-flex align-items-center justify-content-between gap-2 w-100",onClick:()=>{m(!c),x(!1),b(!1)},children:(0,y.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,y.jsx)("i",{className:"bi bi-calendar-plus"}),(0,y.jsx)("span",{children:L()||"Select/Add Session"})]})}),c&&(0,y.jsxs)("div",{className:"dropdown-menu show w-100 p-3 shadow-lg",style:{minWidth:"100%",maxHeight:"350px",overflowY:"auto",position:"absolute",zIndex:1e3},children:[(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsx)("label",{className:"form-label small fw-semibold",children:"Add New Session"}),(0,y.jsxs)("div",{className:"input-group",children:[(0,y.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter session name (e.g., 2024-25)",value:f,onChange:e=>w(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(E(),e.preventDefault())}}),(0,y.jsx)("button",{type:"button",className:"btn btn-primary",onClick:E,disabled:!f.trim(),children:(0,y.jsx)("i",{className:"bi bi-plus-lg"})})]})]}),g.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"dropdown-divider"}),(0,y.jsx)("label",{className:"form-label small fw-semibold",children:"Existing Sessions"}),(0,y.jsx)("div",{className:"list-group",children:g.map((e,s)=>(0,y.jsx)("button",{type:"button",className:"list-group-item list-group-item-action ".concat(P===s?"active":""),onClick:()=>(e=>{A(e),F(null),m(!1)})(s),children:(0,y.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,y.jsx)("span",{children:e.sessionName}),(0,y.jsxs)("span",{className:"badge bg-secondary",children:[e.grades.length," grades"]})]})},s))})]})]})]}),(0,y.jsxs)("div",{className:"position-relative",children:[(0,y.jsx)("button",{type:"button",className:"btn btn-success dropdown-toggle d-flex align-items-center justify-content-between gap-2 w-100",onClick:()=>{null!==P&&(x(!u),m(!1),b(!1))},disabled:null===P,children:(0,y.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,y.jsx)("i",{className:"bi bi-award"}),(0,y.jsx)("span",{children:U()||"Select/Add Grade"}),null!==P&&(null===(a=g[P])||void 0===a?void 0:a.grades.length)>0&&(0,y.jsxs)("span",{className:"badge bg-light text-success ms-2",children:[g[P].grades.length," grades"]}),null===P&&(0,y.jsx)("small",{className:"ms-2 text-light",children:"(Select session first)"})]})}),u&&null!==P&&(0,y.jsxs)("div",{className:"dropdown-menu show w-100 p-3 shadow-lg",style:{minWidth:"100%",maxHeight:"350px",overflowY:"auto",position:"absolute",zIndex:1e3},children:[(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsxs)("label",{className:"form-label small fw-semibold",children:['Add Grade to "',L(),'"']}),(0,y.jsxs)("div",{className:"input-group",children:[(0,y.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter grade name (e.g., Class 9)",value:C,onChange:e=>k(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(z(),e.preventDefault())}}),(0,y.jsx)("button",{type:"button",className:"btn btn-success",onClick:z,disabled:!C.trim(),children:(0,y.jsx)("i",{className:"bi bi-plus-lg"})})]})]}),(null===(n=g[P])||void 0===n?void 0:n.grades.length)>0?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"dropdown-divider"}),(0,y.jsxs)("label",{className:"form-label small fw-semibold",children:['Grades in "',L(),'"']}),(0,y.jsx)("div",{className:"list-group",children:g[P].grades.map((e,s)=>(0,y.jsx)("button",{type:"button",className:"list-group-item list-group-item-action ".concat(H===s?"active":""),onClick:()=>(F(s),void x(!1)),children:(0,y.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,y.jsx)("span",{children:e.gradeName}),(0,y.jsxs)("span",{className:"badge bg-secondary",children:[e.sections.length," sections"]})]})},s))})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"dropdown-divider"}),(0,y.jsxs)("div",{className:"text-center text-muted py-2",children:[(0,y.jsx)("i",{className:"bi bi-inbox"}),(0,y.jsx)("p",{className:"mb-0 small",children:"No grades added yet for this session"})]})]})]})]}),(0,y.jsxs)("div",{className:"position-relative",children:[(0,y.jsx)("button",{type:"button",className:"btn btn-info dropdown-toggle d-flex align-items-center justify-content-between gap-2 w-100",onClick:()=>{null!==H&&(b(!p),m(!1),x(!1))},disabled:null===H,children:(0,y.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,y.jsx)("i",{className:"bi bi-grid-3x3"}),(0,y.jsx)("span",{children:"Add/View Sections"}),null!==H&&D().length>0&&(0,y.jsxs)("span",{className:"badge bg-light text-info ms-2",children:[D().length," sections"]}),null===H&&(0,y.jsx)("small",{className:"ms-2 text-light",children:"(Select grade first)"})]})}),p&&null!==H&&(0,y.jsxs)("div",{className:"dropdown-menu show w-100 p-3 shadow-lg",style:{minWidth:"100%",maxHeight:"350px",overflowY:"auto",position:"absolute",zIndex:1e3},children:[(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsxs)("label",{className:"form-label small fw-semibold",children:['Add Section to "',U(),'"']}),(0,y.jsxs)("div",{className:"input-group",children:[(0,y.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter section name (e.g., A, B, C)",value:S,onChange:e=>Z(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(I(),e.preventDefault())}}),(0,y.jsx)("button",{type:"button",className:"btn btn-info",onClick:I,disabled:!S.trim(),children:(0,y.jsx)("i",{className:"bi bi-plus-lg"})})]})]}),D().length>0?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"dropdown-divider"}),(0,y.jsxs)("label",{className:"form-label small fw-semibold",children:['Sections in "',U(),'"']}),(0,y.jsx)("div",{className:"list-group",children:D().map((e,s)=>(0,y.jsxs)("div",{className:"list-group-item d-flex justify-content-between align-items-center",children:[(0,y.jsx)("span",{children:e}),(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-danger",onClick:()=>(e=>{if(null!==P&&null!==H){const s=[...g];s[P].grades[H].sections.splice(e,1),N(s)}})(s),children:(0,y.jsx)("i",{className:"bi bi-trash"})})]},s))})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"dropdown-divider"}),(0,y.jsxs)("div",{className:"text-center text-muted py-2",children:[(0,y.jsx)("i",{className:"bi bi-inbox"}),(0,y.jsx)("p",{className:"mb-0 small",children:"No sections added yet for this grade"})]})]})]})]})]}),g.length>0&&(0,y.jsxs)("div",{className:"mt-4 p-3 bg-white rounded border",children:[(0,y.jsxs)("h6",{className:"mb-3 fw-semibold d-flex align-items-center gap-2",children:[(0,y.jsx)("i",{className:"bi bi-list-check"}),"Complete Institute Structure"]}),(0,y.jsx)("div",{className:"d-flex flex-column gap-3",children:g.map((e,s)=>(0,y.jsxs)("div",{className:"border rounded p-3",children:[(0,y.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-2",children:[(0,y.jsxs)("span",{className:"badge bg-primary px-3 py-2",children:[(0,y.jsx)("i",{className:"bi bi-calendar3 me-1"}),e.sessionName]}),(0,y.jsxs)("small",{className:"text-muted",children:["(",e.grades.length," grades)"]})]}),e.grades.length>0&&(0,y.jsx)("div",{className:"ms-3 mt-2",children:e.grades.map((e,s)=>(0,y.jsxs)("div",{className:"mb-2",children:[(0,y.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-1",children:[(0,y.jsx)("i",{className:"bi bi-arrow-return-right text-muted"}),(0,y.jsxs)("span",{className:"badge bg-success",children:[(0,y.jsx)("i",{className:"bi bi-award me-1"}),e.gradeName]}),(0,y.jsxs)("small",{className:"text-muted",children:["(",e.sections.length," sections)"]})]}),e.sections.length>0&&(0,y.jsx)("div",{className:"ms-4 d-flex flex-wrap gap-1",children:e.sections.map((e,s)=>(0,y.jsxs)("span",{className:"badge bg-info-subtle text-info",children:["Section ",e]},s))})]},s))})]},s))})]})]})})})}),(0,y.jsx)(v.Z.Footer,{className:"border-0 pt-0",children:(0,y.jsxs)("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[(0,y.jsx)("div",{className:"text-muted small",children:(null===(i=e.data)||void 0===i?void 0:i.instituteCode)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{className:"fw-semibold",children:"Institute Code: "}),(0,y.jsx)("span",{children:e.data.instituteCode})]})}),(0,y.jsxs)("div",{className:"d-flex gap-2",children:[(0,y.jsx)("button",{type:"button",className:"btn btn-sm btn-light",onClick:()=>{e.onHide()},disabled:d,children:"Close"}),(0,y.jsxs)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:async()=>{try{r(!0);const s=g.map(s=>{var l;return{sessionYear:s.sessionName,schoolClasses:s.grades.map(e=>({className:e.gradeName,schoolSections:e.sections.map(e=>({sectionName:e}))})),institute_code:(null===(l=e.data)||void 0===l?void 0:l.instituteCode)||null}});console.log("Formatted API JSON:"),console.log(s),await(0,o.oY)(s),e.onHide()}catch(s){console.error("Error submitting data:",s),alert("Failed to submit institute hierarchy. Please try again.")}finally{r(!1)}},disabled:d||0===g.length,children:[!d&&(0,y.jsxs)("span",{className:"d-flex align-items-center gap-1",children:[(0,y.jsx)("i",{className:"bi bi-check-circle"}),"Submit"]}),d&&(0,y.jsxs)("span",{className:"d-flex align-items-center gap-2",children:[(0,y.jsx)("span",{className:"spinner-border spinner-border-sm"}),"Submitting..."]})]})]})]})})]})]})},P=e=>{var s,l;const[r,g]=(0,t.useState)(!1),[v,j]=(0,t.useState)({instituteName:"",instituteAddress:"",instituteCode:""}),[N,f]=(0,t.useState)(!1),[C,k]=(0,t.useState)(void 0),[P,A]=(0,t.useState)(!1),[H,F]=(0,t.useState)(void 0),[E,z]=(0,t.useState)(!1),[I,L]=(0,t.useState)(void 0),U=(0,a.s0)(),D=e=>{var s,l,t,a;let n;return n="boolean"===typeof e.display?e.display?1:0:e.display,{instituteName:null!==(s=e.instituteName)&&void 0!==s?s:"",instituteAddress:null!==(l=e.instituteAddress)&&void 0!==l?l:"",instituteCode:null!==(t=e.instituteCode)&&void 0!==t?t:"",display:n,questionOptions:null!==(a=e.questionOptions)&&void 0!==a?a:[""],contactPersons:e.contactPersons&&Array.isArray(e.contactPersons)&&e.contactPersons.length?e.contactPersons:[{name:"",email:"",phone:"",gender:"",designation:""}]}},_={columns:[{label:"Name",field:"name",width:150,attributes:{"aria-controls":"DataTable","aria-label":"Name"}},{label:"Code",field:"code",sort:"asc",width:100},{label:"Address",field:"address",width:100},{label:"Actions",field:"actions",sort:"disabled",width:150}],rows:null!==(s=(null!==(l=e.data)&&void 0!==l?l:[]).filter(e=>!!e&&("boolean"===typeof e.display?!0===e.display:"number"===typeof e.display?0!==e.display:"string"===typeof e.display?"0"!==e.display&&"false"!==e.display:Boolean(e.display))).map(s=>{var l,t,a;return{name:null!==(l=s.instituteName)&&void 0!==l?l:"",code:null!==(t=s.instituteCode)&&void 0!==t?t:"",address:null!==(a=s.instituteAddress)&&void 0!==a?a:"",actions:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("button",{type:"button",onClick:()=>{j(s),g(!0)},className:"btn btn-icon btn-primary btn-sm me-3",children:(0,y.jsx)(m.QML,{size:16})}),(0,y.jsx)("button",{type:"button",onClick:async()=>{try{var l;const t=null!==(l=s.id)&&void 0!==l?l:s.instituteCode;if(console.log("Attempting to delete college. Row:",s),console.log("Using deleteId:",t),!t)return console.error("No 'id' or 'instituteCode' found on this row. Cannot call DeleteCollegeData."),void alert("Cannot delete: no valid ID found for this record.");e.setLoading(!0),await(0,o.eh)(t),e.setPageLoading(e=>!e)}catch(t){console.error("Delete failed:",t),alert("Delete failed. Check console for details.")}finally{e.setLoading(!1)}},className:"btn btn-icon btn-danger btn-sm me-3",children:(0,y.jsx)(h.Z,{animation:x.Z,size:22,strokeColor:"#EFF8FE"})}),(0,y.jsxs)(p.Z,{className:"d-inline",children:[(0,y.jsx)(p.Z.Toggle,{variant:"success",size:"sm",id:"dropdown-".concat(s.instituteCode),className:"dropdown-toggle",children:"Actions"}),(0,y.jsxs)(p.Z.Menu,{style:{maxHeight:"unset",overflow:"visible",minWidth:"150px"},renderOnMount:!0,children:[(0,y.jsx)(u.rU,{to:"/course",state:{collegeId:s.instituteCode,college:s.instituteName},style:{textDecoration:"none"},children:(0,y.jsxs)(p.Z.Item,{as:"button",children:[(0,y.jsx)(m.ocf,{size:18,className:"me-2"}),"Add Course"]})}),(0,y.jsxs)(p.Z.Item,{onClick:()=>{k(D(s)),f(!0)},children:[(0,y.jsx)(m.ocf,{size:18,className:"me-2"}),"Info"]}),(0,y.jsxs)(p.Z.Item,{onClick:()=>{F(D(s)),A(!0)},children:[(0,y.jsx)(m.ocf,{size:18,className:"me-2"}),"Add Details"]}),(0,y.jsxs)(p.Z.Item,{onClick:()=>{L(D(s)),z(!0)},children:[(0,y.jsx)(m.ocf,{size:18,className:"me-2"}),"Assign Roles"]})]})]}),(0,y.jsx)(n.Z,{variant:"outline-success",size:"sm",onClick:()=>{e.onUploadClick&&e.onUploadClick(v)},onClickCapture:()=>{0}}),(0,y.jsxs)(n.Z,{variant:"outline-info",size:"sm",className:"me-2",onClick:()=>U("/school/dashboard/".concat(s.instituteCode||s.id)),children:[(0,y.jsx)(i.Pd.Provider,{value:{style:{paddingBottom:"3px"}},children:(0,y.jsx)(d.JZ9,{})}),(0,y.jsx)("span",{style:{marginLeft:6},children:"Dashboard"})]}),(0,y.jsxs)(n.Z,{variant:"outline-success",size:"sm",className:"me-2",onClick:()=>e.onUploadClick&&e.onUploadClick(s),children:[(0,y.jsx)(i.Pd.Provider,{value:{style:{paddingBottom:"3px"}},children:(0,y.jsx)(d.qbQ,{})}),(0,y.jsx)("span",{style:{marginLeft:6},children:"Upload Students"})]}),(0,y.jsx)(n.Z,{hidden:!0,onClick:()=>{}})]})}}))&&void 0!==s?s:[]};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.Vm4,{hover:!0,scrollY:!0,maxHeight:"160vh",entriesOptions:[5,20,25],entries:25,pagesAmount:4,data:_}),(0,y.jsx)(b.default,{show:r,onHide:()=>g(!1),data:v,setPageLoading:e.setPageLoading}),(0,y.jsx)(w,{show:N,onHide:()=>f(!1),data:C,setPageLoading:e.setPageLoading}),(0,y.jsx)(Z,{show:P,onHide:()=>A(!1),data:H,setPageLoading:e.setPageLoading}),(0,y.jsx)(S,{show:E,onHide:()=>z(!1),data:I,setPageLoading:e.setPageLoading})]})};var A=l(39763),H=l(63027);const F=e=>{let{show:s,onHide:l,college:a,onUploaded:i}=e;const[d,o]=(0,t.useState)(null),[r,c]=(0,t.useState)(!1),[m,u]=(0,t.useState)(null);return(0,y.jsxs)(A.Z,{show:s,onHide:l,size:"lg",centered:!0,children:[(0,y.jsx)(A.Z.Header,{closeButton:!0,children:(0,y.jsx)(A.Z.Title,{children:"Upload Students Excel"})}),(0,y.jsx)(A.Z.Body,{children:(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("strong",{children:"Institute:"})," ",(null===a||void 0===a?void 0:a.instituteName)||"\u2014"]}),(0,y.jsxs)(H.Z.Group,{className:"mt-3",children:[(0,y.jsx)(H.Z.Label,{children:"Student file (.xlsx, .xls, .csv)"}),(0,y.jsx)(H.Z.Control,{type:"file",accept:".xlsx,.xls,.csv",onChange:e=>{var s;o((null===(s=e.target.files)||void 0===s?void 0:s[0])||null)}}),(0,y.jsx)(H.Z.Text,{className:"text-muted",children:"First row should contain headers (name, email, rollNo etc.)"})]}),m&&(0,y.jsx)("div",{className:"mt-2",children:m})]})}),(0,y.jsxs)(A.Z.Footer,{children:[(0,y.jsx)(n.Z,{variant:"secondary",onClick:l,disabled:r,children:"Close"}),(0,y.jsx)(n.Z,{variant:"primary",onClick:async()=>{if(d&&a){c(!0),u(null);try{const e=new FormData;e.append("file",d);if(!(await fetch("/api/colleges/".concat(a.instituteCode||a.id,"/students/upload"),{method:"POST",body:e})).ok)throw new Error("Upload failed");u("Uploaded successfully"),i&&i()}catch(e){console.error(e),u("Upload failed")}finally{c(!1)}}else u("Please select a file and institute.")},disabled:r||!d,children:r?"Uploading\u2026":"Upload"})]})]})},E=()=>{const[e,s]=(0,t.useState)(!1),[l,c]=(0,t.useState)([]),[m,u]=(0,t.useState)(!1),[h,x]=(0,t.useState)(["false"]),[p,b]=(0,t.useState)(!1),[g,v]=(0,t.useState)(null);(0,a.s0)();(0,t.useEffect)(()=>{u(!0);try{(0,o.hi)().then(e=>{c(e.data),u(!1)})}catch(e){console.error(e)}},[h]);return(0,y.jsxs)("div",{className:"card",children:[m&&(0,y.jsxs)("span",{className:"indicator-progress m-5",style:{display:"block"},children:["Please wait..."," ",(0,y.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]}),!m&&(0,y.jsxs)("div",{className:"card-header border-0 pt-6",children:[(0,y.jsx)("div",{className:"card-title",children:(0,y.jsx)("h1",{children:"Institutes List"})}),(0,y.jsx)("div",{className:"card-toolbar",children:(0,y.jsx)("div",{className:"d-flex justify-content-end",children:(0,y.jsx)("div",{style:{display:"flex",gap:8},children:(0,y.jsx)(n.Z,{variant:"primary",onClick:()=>{s(!0)},children:(0,y.jsx)(i.Pd.Provider,{value:{style:{paddingBottom:"4px"}},children:(0,y.jsxs)("div",{children:["Add Institute ",(0,y.jsx)(d.eAf,{size:21})]})})})})})})]}),!m&&(0,y.jsx)("div",{className:"card-body pt-5",children:(0,y.jsx)(P,{data:l,setLoading:u,setPageLoading:x,onUploadClick:e=>{v(e),b(!0)}})}),(0,y.jsx)(r.Z,{setPageLoading:x,show:e,onHide:()=>s(!1)}),(0,y.jsx)(F,{show:p,onHide:()=>b(!1),college:g,onUploaded:()=>{b(!1),v(null),x([String(Date.now())])}})]})}},62094:(e,s,l)=>{l.r(s),l.d(s,{default:()=>x});var t=l(1413),a=l(28182),n=l(92506),i=l(72791),d=l(28403),o=l(70099),r=l(7755),c=l(81724),m=l(54624),u=l(80184);const h=c.Ry().shape({instituteName:c.Z_().required(),instituteAddress:c.Z_().required(),instituteCode:c.Z_().required(),maxStudents:c.Z_().required(),maxContactPersons:c.Z_().required()}),x=e=>{const[s,l]=(0,i.useState)(!1);var c={instituteName:e.data.instituteName,instituteAddress:e.data.instituteAddress,instituteCode:e.data.instituteCode,maxStudents:e.data.maxStudents,maxContactPersons:e.data.maxContactPersons,display:1};const x=(0,n.TA)({enableReinitialize:!0,initialValues:c,validationSchema:h,onSubmit:s=>{try{l(!0),(0,m.J6)(s).then(()=>{e.onHide(!1),e.setPageLoading(["true"])})}catch(t){console.error(t),window.location.replace("/error")}}});return(0,u.jsxs)(d.Z,(0,t.Z)((0,t.Z)({},e),{},{"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,u.jsxs)(d.Z.Header,{children:[(0,u.jsx)(d.Z.Title,{children:(0,u.jsx)("h1",{children:"Edit College"})}),(0,u.jsx)("div",{className:"btn btn-sm btn-icon btn-active-color-primary",onClick:e.onHide,children:(0,u.jsx)(o.Z,{animation:r.Z,size:28,strokeColor:"#181C32",reverse:!0})})]}),(0,u.jsxs)("form",{className:"form w-100 fv-plugins-bootstrap5 fv-plugins-framework",onSubmit:x.handleSubmit,children:[(0,u.jsx)(d.Z.Body,{children:(0,u.jsx)("div",{className:"modal-body",children:(0,u.jsxs)("div",{className:"scroll-y me-n7 pe-7",id:"kt_modal_add_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_add_header","data-kt-scroll-wrappers":"#kt_modal_add_scroll","data-kt-scroll-offset":"300px",children:[(0,u.jsxs)("div",{className:"fv-row mb-7",children:[(0,u.jsx)("label",{className:"fs-6 fw-bold mb-2",children:"Institute Code :"}),(0,u.jsx)("input",(0,t.Z)((0,t.Z)({placeholder:"Enter Institute Code",type:"text",autoComplete:"off"},x.getFieldProps("instituteCode")),{},{className:"form-control form-control-lg form-control-solid",disabled:!0}))]}),(0,u.jsxs)("div",{className:"fv-row mb-7",children:[(0,u.jsx)("label",{className:"required fs-6 fw-bold mb-2",children:"College Name :"}),(0,u.jsx)("input",(0,t.Z)((0,t.Z)({placeholder:"Enter College Name",type:"text",autoComplete:"off"},x.getFieldProps("instituteName")),{},{className:(0,a.default)("form-control form-control-lg form-control-solid",{"is-invalid text-danger":x.touched.instituteName&&x.errors.instituteName},{"is-valid":x.touched.instituteName&&!x.errors.instituteName})})),x.touched.instituteName&&x.errors.instituteName&&(0,u.jsx)("div",{className:"fv-plugins-message-container",children:(0,u.jsx)("div",{className:"fv-help-block text-danger",children:(0,u.jsx)("span",{role:"alert",children:"College Name is Required"})})})]}),(0,u.jsxs)("div",{className:"fv-row mb-7",children:[(0,u.jsx)("label",{className:"required fs-6 fw-bold mb-2",children:"Institute Address :"}),(0,u.jsx)("input",(0,t.Z)((0,t.Z)({placeholder:"Enter Institute Address",type:"text",autoComplete:"off"},x.getFieldProps("instituteAddress")),{},{className:(0,a.default)("form-control form-control-lg form-control-solid",{"is-invalid text-danger":x.touched.instituteAddress&&x.errors.instituteAddress},{"is-valid":x.touched.instituteAddress&&!x.errors.instituteAddress})})),x.touched.instituteAddress&&x.errors.instituteAddress&&(0,u.jsx)("div",{className:"fv-plugins-message-container",children:(0,u.jsx)("div",{className:"fv-help-block text-danger",children:(0,u.jsx)("span",{role:"alert",children:"Institute Address is Required"})})})]}),(0,u.jsxs)("div",{className:"fv-row mb-7",children:[(0,u.jsx)("label",{className:"required fs-6 fw-bold mb-2",children:"Maximum Students :"}),(0,u.jsx)("input",(0,t.Z)((0,t.Z)({placeholder:"Enter Maximum Students",type:"text",autoComplete:"off"},x.getFieldProps("maxStudents")),{},{className:(0,a.default)("form-control form-control-lg form-control-solid",{"is-invalid text-danger":x.touched.maxStudents&&!!x.errors.maxStudents},{"is-valid":x.touched.maxStudents&&!x.errors.maxStudents})})),x.touched.maxStudents&&x.errors.maxStudents&&(0,u.jsx)("div",{className:"fv-plugins-message-container",children:(0,u.jsx)("div",{className:"fv-help-block text-danger",children:(0,u.jsx)("span",{role:"alert",children:"Maximum Students is Required"})})})]}),(0,u.jsxs)("div",{className:"fv-row mb-7",children:[(0,u.jsx)("label",{className:"required fs-6 fw-bold mb-2",children:"Maximum Contact Persons :"}),(0,u.jsx)("input",(0,t.Z)((0,t.Z)({placeholder:"Enter Maximum Contact Persons",type:"text",autoComplete:"off"},x.getFieldProps("maxContactPersons")),{},{className:(0,a.default)("form-control form-control-lg form-control-solid",{"is-invalid text-danger":x.touched.maxContactPersons&&!!x.errors.maxContactPersons},{"is-valid":x.touched.maxContactPersons&&!x.errors.maxContactPersons})})),x.touched.maxContactPersons&&x.errors.maxContactPersons&&(0,u.jsx)("div",{className:"fv-plugins-message-container",children:(0,u.jsx)("div",{className:"fv-help-block text-danger",children:(0,u.jsx)("span",{role:"alert",children:"Maximum Contact Persons is Required"})})})]})]})})}),(0,u.jsxs)(d.Z.Footer,{children:[(0,u.jsx)("button",{className:"btn btn-sm btn-light btn-active-light-secoundary",onClick:e.onHide,children:"Close"}),(0,u.jsxs)("button",{type:"submit",id:"kt_sign_up_submit",className:"btn btn-sm btn-primary btn-active-light-secoundary",disabled:x.isSubmitting||!x.isValid,children:[!s&&(0,u.jsx)("span",{className:"indicator-label",children:"Submit"}),s&&(0,u.jsxs)("span",{className:"indicator-progress",style:{display:"block"},children:["Please wait..."," ",(0,u.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})]})]}))}}}]);
//# sourceMappingURL=407.ea11a1d2.chunk.js.map